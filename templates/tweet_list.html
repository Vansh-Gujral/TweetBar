{% extends "base.html" %}
{% block title %} Home {% endblock %}
{% block content %}
<h2 class="text-center mb-4">Welcome to TweetBar</h2>
<div class="d-flex justify-content-end mb-3">
  <a href="{% url 'tweet_create' %}" class="btn btn-primary btn-sm">+ Tweet</a>
</div>

<!-- Grid Container -->
<div class="container">
  <div class="tweet-grid">
    {% for tweet in tweets %}
    <div class="card shadow-sm">
      
      {% if tweet.photo %}
        <div class="card-img-container">
          <img src="{{ tweet.photo.url }}" alt="Tweet image" class="card-img-top">
        </div>
      {% else %}
        <div class="card-img-container">
          <img src="https://via.placeholder.com/350x220?text=No+Image" alt="No image" class="card-img-top">
        </div>
      {% endif %}
      
      <div class="card-body d-flex flex-column">
        <h6 class="card-title text-primary mb-2">@{{ tweet.user.username }}</h6>
        <p class="card-text small flex-grow-1">{{ tweet.text|truncatewords:25 }}</p>
        
        {% if tweet.user == user %}
        <div class="mt-2 d-flex gap-2">
          <a href="{% url 'tweet_edit' tweet.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
          <a href="{% url 'deleteTweet' tweet.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
        </div>
        {% endif %}
      </div>
    </div>
    {% empty %}
      <p class="text-center text-muted">No tweets yet. Be the first to post!</p>
    {% endfor %}
  </div>
</div>

<style>
  .tweet-grid {
    display: grid;
    grid-template-columns: repeat(4, 350px); /* Always 4 per row */
    gap: 20px;
    justify-content: center; /* Center the grid in container */
  }

  .card {
    width: 350px;
    height: 350px;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .card-img-container {
    width: 100%;
    height: 220px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f9fa;
  }

  .card-img-top {
    max-height: 100%;
    max-width: 100%;
    object-fit: contain; /* âœ… Prevent cropping */
  }
</style>
{% endblock %}
